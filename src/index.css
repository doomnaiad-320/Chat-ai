@tailwind base;
@tailwind components;
@tailwind utilities;

/* 全局样式重置和基础设置 */
@layer base {
  * {
    box-sizing: border-box;
  }

  html {
    font-size: 16px;
    -webkit-text-size-adjust: 100%;
    -webkit-tap-highlight-color: transparent;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    background-color: #FFF5EB;
    color: #5A4B41;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
  }

  /* 移动端安全区域适配 */
  body {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  /* 移动端优化 */
  * {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  input, textarea {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }

  /* 防止iOS Safari缩放 */
  input[type="text"],
  input[type="password"],
  input[type="email"],
  input[type="url"],
  input[type="number"],
  textarea {
    font-size: 16px;
  }

  /* 滚动优化 */
  .scroll-smooth {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
  }
}

/* 自定义组件样式 */
@layer components {
  /* 毛玻璃效果基础类 */
  .glass-effect {
    @apply bg-white border border-gray-200;
    background-color: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(10px);
  }

  /* 聊天气泡基础样式 */
  .chat-bubble {
    @apply rounded-bubble px-4 py-2 max-w-xs shadow-bubble;
    word-wrap: break-word;
    position: relative;
  }

  .chat-bubble-user {
    @apply bg-primary-400 text-white ml-auto;
  }

  .chat-bubble-ai {
    @apply bg-white text-text-primary mr-auto;
  }

  /* 按钮基础样式 */
  .btn-primary {
    @apply bg-primary-400 text-white px-6 py-3 rounded-bubble font-medium;
    @apply hover:bg-primary-500 active:scale-95 transition-all duration-200;
    @apply shadow-bubble hover:shadow-glow;
  }

  .btn-secondary {
    @apply bg-white text-primary-400 px-6 py-3 rounded-bubble font-medium;
    @apply border border-primary-400 hover:bg-primary-50 active:scale-95;
    @apply transition-all duration-200 shadow-bubble;
  }

  /* 输入框样式 */
  .input-field {
    @apply w-full px-4 py-3 rounded-bubble border border-primary-200;
    @apply bg-white focus:outline-none focus:ring-2;
    @apply focus:ring-primary-400 focus:border-transparent;
    @apply placeholder-text-muted transition-all duration-200;
    background-color: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(4px);
  }

  /* 卡片样式 */
  .card {
    @apply bg-white rounded-card p-6 shadow-card;
    @apply border border-gray-200;
    background-color: rgba(255, 255, 255, 0.8);
    border-color: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(4px);
  }

  /* 头像样式 */
  .avatar {
    @apply w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-secondary-400;
    @apply flex items-center justify-center text-white font-medium;
    @apply shadow-bubble;
  }

  .avatar-large {
    @apply w-16 h-16 text-lg;
  }

  /* 标签样式 */
  .tag {
    @apply inline-block px-3 py-1 rounded-full text-sm font-medium;
    @apply bg-primary-100 text-primary-700 mr-2 mb-2;
  }

  /* 导航栏样式 */
  .navbar {
    @apply fixed top-0 left-0 right-0 z-50;
    @apply bg-white border-b border-gray-200;
    @apply px-4 py-3 flex items-center justify-between;
    background-color: rgba(255, 255, 255, 0.8);
    border-color: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(10px);
  }

  /* 底部标签栏样式 */
  .tabbar {
    @apply fixed bottom-0 left-0 right-0 z-50;
    @apply bg-white border-t border-gray-200;
    @apply px-4 py-2 flex items-center justify-around;
    @apply pb-[calc(0.5rem+env(safe-area-inset-bottom))];
    background-color: rgba(255, 255, 255, 0.9);
    border-color: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(10px);
  }

  .tab-item {
    @apply flex flex-col items-center justify-center p-2 rounded-lg;
    @apply text-text-muted hover:text-primary-400 transition-colors duration-200;
    @apply active:scale-95;
  }

  .tab-item.active {
    @apply text-primary-400 bg-primary-50;
  }

  /* 移动端特定样式 */
  .mobile-container {
    @apply max-w-md mx-auto bg-white min-h-screen;
  }

  /* 触摸友好的按钮 */
  .touch-button {
    @apply min-h-[44px] min-w-[44px] flex items-center justify-center;
  }

  /* 长文本处理 */
  .text-ellipsis-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .text-ellipsis-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* 加载动画 */
  .loading-dots {
    @apply flex space-x-1;
  }

  .loading-dots > div {
    @apply w-2 h-2 bg-current rounded-full animate-pulse;
  }

  .loading-dots > div:nth-child(1) {
    animation-delay: 0ms;
  }

  .loading-dots > div:nth-child(2) {
    animation-delay: 150ms;
  }

  .loading-dots > div:nth-child(3) {
    animation-delay: 300ms;
  }
}

/* 响应式设计 */
@media (max-width: 640px) {
  .navbar {
    @apply px-3 py-2;
  }

  .tabbar {
    @apply px-2 py-1;
  }

  .card {
    @apply p-4;
  }

  .chat-bubble {
    @apply px-3 py-2 text-sm;
  }
}

/* 横屏适配 */
@media (orientation: landscape) and (max-height: 500px) {
  .navbar {
    @apply py-2;
  }

  .tabbar {
    @apply py-1;
  }
}

/* 高分辨率屏幕优化 */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .avatar {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
}
